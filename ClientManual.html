

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Client Manual &mdash; Mantis 3.1.4 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Mantis 3.1.4 documentation" href="index.html"/>
        <link rel="next" title="Device Configuration Standards" href="DeviceConfigStandards.html"/>
        <link rel="prev" title="Welcome to Mantis’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Mantis
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Client Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#purpose">Purpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#full-option-list">Full option list</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#client-options">Client options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lockout-key">Lockout Key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#message-type-and-target">Message Type and Target</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#message-type">Message Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="#target">Target</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#server-options">Server Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#special-features">Special Features</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DeviceConfigStandards.html">Device Configuration Standards</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DeviceConfigStandards.html#required-by-the-file-writer">Required by the file writer</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeviceConfigStandards.html#may-be-required-in-the-future">May be required in the future</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Reminders.html">Reminders</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Reminders.html#purpose">Purpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reminders.html#using-mantis">Using Mantis</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reminders.html#developing-mantis">Developing Mantis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="wiki/wiki.html">Wiki</a><ul>
<li class="toctree-l2"><a class="reference internal" href="wiki/Mantis-DAQ-in-Windows.html">Mantis DAQ in WIndows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="wiki/Mantis-DAQ-in-Windows.html#specifications">Specifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="wiki/Mantis-DAQ-in-Windows.html#required-software">Required Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="wiki/Mantis-DAQ-in-Windows.html#useful-documentation">Useful documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="wiki/Mantis-DAQ-in-Windows.html#install-protobuf">Install Protobuf</a></li>
<li class="toctree-l3"><a class="reference internal" href="wiki/Mantis-DAQ-in-Windows.html#install-mantis">Install Mantis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wiki/Mantis-logging-facilities.html">Mantis Logging Facilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="wiki/Usage.html">Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="from_doxygen.html">Full Doxygen Reference</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Mantis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Client Manual</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/ClientManual.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="client-manual">
<h1>Client Manual<a class="headerlink" href="#client-manual" title="Permalink to this headline">¶</a></h1>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">mantis_client</span></code> is a utility that is used to control the <code class="docutils literal"><span class="pre">mantis_server</span></code>.  This is done by sending requests using
<a class="reference external" href="https://github.com/project8/hardware/wiki/Wire-Protocol">dripline-standard</a> AMQP messages.
The <code class="docutils literal"><span class="pre">mantis_server</span></code> <a class="reference internal" href="ServerAPI.html"><em>API</em></a> describes the instructions that are available.  This manual describes
how to use the <code class="docutils literal"><span class="pre">mantis_client</span></code> to access that API.</p>
<p>The full server API is accessible from a general dripline client, such as <code class="docutils literal"><span class="pre">dripline_agent</span></code>.  The <code class="docutils literal"><span class="pre">mantis_client</span></code>
includes some functionality that is specific to Mantis, such as loading the full acquisition configuration from a JSON file.
That extended functionality will be described below.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">mantis_client</span> <span class="pre">[client</span> <span class="pre">options]</span> <span class="pre">key=[lockout</span> <span class="pre">key]</span> <span class="pre">do=[message</span> <span class="pre">type]</span> <span class="pre">dest=[queue].[mantis</span> <span class="pre">target]</span> <span class="pre">[server</span> <span class="pre">options]</span></code></p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>The queue name is assumed to be <code class="docutils literal"><span class="pre">mantis</span></code> in these examples.
The first two examples show the usage of client options, and in all of the later examples, any client options are left out for clarity.</p>
<ul>
<li><p class="first">Read client configuration from a JSON file:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client config=my_config.json
</pre></div>
</div>
</li>
<li><p class="first">Specify the broker address:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client amqp.broker=myrna.local
</pre></div>
</div>
</li>
<li><p class="first">Add a PXIe5122 digitizer called pxie1:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client do=cmd dest=mantis.add.device pxie5122=pxie1
</pre></div>
</div>
</li>
<li><p class="first">Remove a digitizer called my_px1500:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client do=cmd dest=[queue].remove.device.my_px1500
</pre></div>
</div>
</li>
<li><p class="first">Set the &#8220;enabled&#8221; value of the pxie1 digitizer to <code class="docutils literal"><span class="pre">true</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client do=set dest=mantis.devices.pxie1.enabled value=true
</pre></div>
</div>
</li>
<li><p class="first">Set the run duration to 100 ms:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client do=set dest=mantis.duration value=100
</pre></div>
</div>
</li>
<li><p class="first">Get the master acquisition configuration from the server; the option to save the configuration as a JSON file is used:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client do=get dest=mantis.acq-config save.json=my_config.json
</pre></div>
</div>
</li>
<li><p class="first">Replace the server&#8217;s master acquisition configuration with the contents of the specified file:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client do=cmd dest=mantis.acq-config load.json=my_config.json
</pre></div>
</div>
</li>
<li><p class="first">Submit an acquisition request to the queue:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client do=run dest=mantis file=my_file.egg
</pre></div>
</div>
</li>
<li><p class="first">Send any request with a lockout key:</p>
<div class="highlight-python"><div class="highlight"><pre>mantis_client key=0123456789abcdef0123456789abcdef [...]
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="full-option-list">
<h2>Full option list<a class="headerlink" href="#full-option-list" title="Permalink to this headline">¶</a></h2>
<div class="section" id="client-options">
<h3>Client options<a class="headerlink" href="#client-options" title="Permalink to this headline">¶</a></h3>
<p>The client options allow the user to configure the client itself.  These options do not get passed to the server.</p>
<p>Load a client config file. This file is parsed and used by the client.
In it you can specify any option that would otherwise be specified on the command line:</p>
<div class="highlight-python"><div class="highlight"><pre>config=[json file]
</pre></div>
</div>
<p>Specify the AMQP broker details:</p>
<div class="highlight-python"><div class="highlight"><pre>amqp.broker=[location (default=localhost)]
amqp.broker-port=[port # (default=5672)]
amqp.exchange=[exchange name (default=requests)]
</pre></div>
</div>
</div>
<div class="section" id="lockout-key">
<h3>Lockout Key<a class="headerlink" href="#lockout-key" title="Permalink to this headline">¶</a></h3>
<p>Mantis follows the dripline wire protocol specification for the <a class="reference external" href="https://github.com/project8/hardware/wiki/Wire-Protocol#lockout">lockout feature</a>.</p>
<p>The key can be provided in either supported format:</p>
<div class="highlight-python"><div class="highlight"><pre>key=0123456789abcdef0123456789abcdef
key=01234567-89ab-cdef-0123-456789abcdef
</pre></div>
</div>
</div>
<div class="section" id="message-type-and-target">
<h3>Message Type and Target<a class="headerlink" href="#message-type-and-target" title="Permalink to this headline">¶</a></h3>
<div class="section" id="message-type">
<h4>Message Type<a class="headerlink" href="#message-type" title="Permalink to this headline">¶</a></h4>
<p>The message type tells the server what type of request it&#8217;s receiving.</p>
<p>The message types used by Mantis are:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">OP_RUN:</th><td class="field-body"><code class="docutils literal"><span class="pre">do=run</span></code> &#8211; Queue an acquisition with the current acquisition configuration</td>
</tr>
<tr class="field-even field"><th class="field-name">OP_GET:</th><td class="field-body"><code class="docutils literal"><span class="pre">do=get</span></code> &#8211; Request information from the server</td>
</tr>
<tr class="field-odd field"><th class="field-name">OP_SET:</th><td class="field-body"><code class="docutils literal"><span class="pre">do=set</span></code> &#8211; Change a setting in the acquisition configuration</td>
</tr>
<tr class="field-even field"><th class="field-name">OP_CMD:</th><td class="field-body"><code class="docutils literal"><span class="pre">do=cmd</span></code> &#8211; Run a command</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="target">
<h4>Target<a class="headerlink" href="#target" title="Permalink to this headline">¶</a></h4>
<p>The target is a combination of the AMQP queue name used by the server, and a Mantis-specific specifier that
tells the server how to direct the request.  In the parlance of dripline and the <a class="reference internal" href="ServerAPI.html"><em>Server API</em></a>, the
target is the message routing key, and it combines the queue and the routing key specifier.</p>
<p>The general form for the target is:</p>
<div class="highlight-python"><div class="highlight"><pre>dest=[queue].[mantis target]
</pre></div>
</div>
<p>The options for the <code class="docutils literal"><span class="pre">mantis</span> <span class="pre">target</span></code> are given as Routing Key Specifiers in the <a class="reference internal" href="ServerAPI.html"><em>Server API</em></a>.</p>
</div>
</div>
<div class="section" id="server-options">
<h3>Server Options<a class="headerlink" href="#server-options" title="Permalink to this headline">¶</a></h3>
<p>In general the server options that are passed to the <code class="docutils literal"><span class="pre">mantis_client</span></code> are directly placed into the request payload
as <code class="docutils literal"><span class="pre">(name:</span> <span class="pre">value)</span></code> pairs.  The available options are listed under the Payload sections in the <a class="reference internal" href="ServerAPI.html"><em>Server API</em></a>.</p>
<div class="section" id="special-features">
<h4>Special Features<a class="headerlink" href="#special-features" title="Permalink to this headline">¶</a></h4>
<p>In addition to those options, the <code class="docutils literal"><span class="pre">mantis_client</span></code> has a few special features that get specified here, but are not
directly included in the payload.  They depend on the message type and Mantis target:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">any:</th><td class="field-body"><code class="docutils literal"><span class="pre">save.json=[filename</span> <span class="pre">(string)]</span></code> &#8211; <em>(optional)</em> File in which to save the information returned.  This is primarily useful for saving the acquisition configuration for loading via the client, or saving the full configuration for loading into the server at startup.</td>
</tr>
<tr class="field-even field"><th class="field-name">replace-config:</th><td class="field-body"><code class="docutils literal"><span class="pre">load.json=[filename]</span></code> &#8211; <em>(optional)</em> This JSON file will be parsed by the client, and the contents (plus any other instruction options given) will be used by the server to replace the run configuration.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="DeviceConfigStandards.html" class="btn btn-neutral float-right" title="Device Configuration Standards" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to Mantis’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Project 8 Collaboration.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.1.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>